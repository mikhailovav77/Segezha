ВЫБРАТЬ
	ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка) КАК Организация,
	"" КАК Постфикс
ПОМЕСТИТЬ ТЗИндексов
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ХозрасчетныйДвиженияССубконто.Период КАК Период,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.СчетДт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
			ТОГДА ХозрасчетныйДвиженияССубконто.СчетКт
		ИНАЧЕ ХозрасчетныйДвиженияССубконто.СчетДт
	КОНЕЦ КАК СчетДт,
	ХозрасчетныйДвиженияССубконто.СубконтоДт1 КАК СубконтоДт1,
	ХозрасчетныйДвиженияССубконто.СубконтоДт2 КАК СубконтоДт2,
	ХозрасчетныйДвиженияССубконто.СубконтоДт3 КАК СубконтоДт3,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 КАК ВидСубконтоДт1,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 КАК ВидСубконтоДт2,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 КАК ВидСубконтоДт3,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.СчетКт = ЗНАЧЕНИЕ(ПланСчетов.Хозрасчетный.ПустаяСсылка)
			ТОГДА ХозрасчетныйДвиженияССубконто.СчетДт
		ИНАЧЕ ХозрасчетныйДвиженияССубконто.СчетКт
	КОНЕЦ КАК СчетКт,
	ХозрасчетныйДвиженияССубконто.СубконтоКт1 КАК СубконтоКт1,
	ХозрасчетныйДвиженияССубконто.СубконтоКт2 КАК СубконтоКт2,
	ХозрасчетныйДвиженияССубконто.СубконтоКт3 КАК СубконтоКт3,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 КАК ВидСубконтоКт1,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 КАК ВидСубконтоКт2,
	ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 КАК ВидСубконтоКт3,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.ВалютнаяСуммаДт <> 0
			ТОГДА ХозрасчетныйДвиженияССубконто.ВалютнаяСуммаДт
		КОГДА ХозрасчетныйДвиженияССубконто.ВалютнаяСуммаКт <> 0
			ТОГДА ХозрасчетныйДвиженияССубконто.ВалютнаяСуммаКт
		ИНАЧЕ 0
	КОНЕЦ КАК СуммаВал,
	ХозрасчетныйДвиженияССубконто.Сумма КАК Сумма,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА -1
		ИНАЧЕ 1
	КОНЕЦ КАК ЗнакОборота,
	ЛОЖЬ КАК ВыделитьНДС,
	ЛОЖЬ КАК НеФильтроватьКонтрагента,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК КонтрПоДТ,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК КонтрПоКТ,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
					И НЕ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт1
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
					И НЕ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт2
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
					И НЕ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.РасходыБудущихПериодов)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт3
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт1
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт2
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
		КОНЕЦ КАК Справочник.Контрагенты) КАК Контрагент,
	ХозрасчетныйДвиженияССубконто.Регистратор КАК Регистратор,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт1
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт2
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоДт3
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт1
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт2
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
		КОНЕЦ КАК Справочник.Организации) КАК ОбособленноеПодразделение,
	ВЫБОР
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ЭтоОП,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт1
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт2
			КОГДА ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Контрагенты)
					И НЕ ХозрасчетныйДвиженияССубконто.СчетДт.Код ПОДОБНО "58.01.2%"
				ТОГДА ХозрасчетныйДвиженияССубконто.СубконтоКт3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
		КОНЕЦ КАК Справочник.Контрагенты) КАК КонтрагентКтУАгента
ПОМЕСТИТЬ ТЗПроводок
ИЗ
	РегистрБухгалтерии.Хозрасчетный.ДвиженияССубконто(
			НАЧАЛОПЕРИОДА(&ДатаНач, ГОД),
			КОНЕЦПЕРИОДА(&ДатаКон, ДЕНЬ),
			Организация = &Организация
				И Активность = ИСТИНА
				И ВЫБОР
					КОГДА Счет.Код = "020"
							ИЛИ КорСчет.Код = "020"
							ИЛИ Счет.Код = "021"
							ИЛИ КорСчет.Код = "021"
						ТОГДА ИСТИНА
					ИНАЧЕ ВЫБОР
							КОГДА НЕ Счет.Забалансовый
									И НЕ КорСчет.Забалансовый
								ТОГДА Счет.Родитель.Код <> "50"
										И Счет.Код <> "51"
										И Счет.Код <> "52"
										И Счет.Родитель.Код <> "55"
										И Счет.Родитель.Код <> "57"
										И Счет.Код <> "10.07"
										И Счет.Код <> "63"
										И КорСчет.Родитель.Код <> "50"
										И КорСчет.Код <> "51"
										И КорСчет.Код <> "52"
										И КорСчет.Родитель.Код <> "55"
										И КорСчет.Родитель.Код <> "57"
										И КорСчет.Код <> "10.07"
										И КорСчет.Код <> "63"
							ИНАЧЕ ЛОЖЬ
						КОНЕЦ
				КОНЕЦ,
			,
			) КАК ХозрасчетныйДвиженияССубконто
ГДЕ
	(ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения)
			ИЛИ ХозрасчетныйДвиженияССубконто.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения))
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВЫРАЗИТЬ(неоКонтрагентыГруппыКонтрагентыГруппы.Наименование КАК СТРОКА(100)) КАК Наименование,
	неоКонтрагентыГруппыКонтрагентыГруппы.ИНН КАК ИНН,
	ВЫРАЗИТЬ(неоКонтрагентыГруппыКонтрагентыГруппы.КПП КАК СТРОКА(9)) КАК КПП,
	неоКонтрагентыГруппыКонтрагентыГруппы.ОтношениеКГруппе КАК ОтношениеКГруппе,
	неоКонтрагентыГруппыКонтрагентыГруппы.ДатаИзмененияСтатуса КАК ДатаИзмененияСтатуса,
	неоКонтрагентыГруппыКонтрагентыГруппы.ДатаВыбытия КАК ДатаВыбытия
ПОМЕСТИТЬ ВТКонтрагентыГруппы
ИЗ
	Документ.неоКонтрагентыГруппы.КонтрагентыГруппы КАК неоКонтрагентыГруппыКонтрагентыГруппы
ГДЕ
	неоКонтрагентыГруппыКонтрагентыГруппы.Ссылка.Дата МЕЖДУ НАЧАЛОПЕРИОДА(&ДатаКон, МЕСЯЦ) И КОНЕЦПЕРИОДА(&ДатаКон, ДЕНЬ)
	И неоКонтрагентыГруппыКонтрагентыГруппы.Ссылка.ПометкаУдаления = ЛОЖЬ
	И неоКонтрагентыГруппыКонтрагентыГруппы.Ссылка.Проведен = ИСТИНА
	И (неоКонтрагентыГруппыКонтрагентыГруппы.ОтношениеКГруппе = ЗНАЧЕНИЕ(Перечисление.неоВидыОтношенийКГруппе.Материнское)
			ИЛИ неоКонтрагентыГруппыКонтрагентыГруппы.ОтношениеКГруппе = ЗНАЧЕНИЕ(Перечисление.неоВидыОтношенийКГруппе.Дочернее))

ИНДЕКСИРОВАТЬ ПО
	ИНН,
	КПП
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	(ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СчетКт.Код
			ИНАЧЕ ТЗПроводок.СчетДт.Код
		КОНЕЦ КАК СТРОКА(10))) + ", " + (ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СчетКт.Наименование
			ИНАЧЕ ТЗПроводок.СчетДт.Наименование
		КОНЕЦ КАК СТРОКА(20))) + ", " + (ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт1.Наименование
			ИНАЧЕ ТЗПроводок.СубконтоДт1.Наименование
		КОНЕЦ КАК СТРОКА(50))) КАК СчетИАналитика,
	ТЗПроводок.Контрагент КАК Контрагент,
	ТЗПроводок.Контрагент.ИНН КАК ИНН,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
				И НЕ ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетКт.Код
		КОГДА ТЗПроводок.КонтрПоДТ
				И ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетДт.Код
		ИНАЧЕ ТЗПроводок.СчетДт.Код
	КОНЕЦ КАК СтрокаСчет,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
				И НЕ ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетДт.Код
		КОГДА ТЗПроводок.КонтрПоДТ
				И ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетКт.Код
		ИНАЧЕ ТЗПроводок.СчетКт.Код
	КОНЕЦ КАК СтрокаКоррСчет,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт1
			ИНАЧЕ ТЗПроводок.СубконтоДт1
		КОНЕЦ) КАК СтрокаСубконто1,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт2
			ИНАЧЕ ТЗПроводок.СубконтоДт2
		КОНЕЦ) КАК СтрокаСубконто2,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт3
			ИНАЧЕ ТЗПроводок.СубконтоДт3
		КОНЕЦ) КАК СтрокаСубконто3,
	ВЫРАЗИТЬ(ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL) КАК Перечисление.неоФормыОтчетности) КАК ФО,
	"" КАК НазваниеОперации,
	"" КАК Статья,
	ТЗПроводок.СуммаВал * ТЗПроводок.ЗнакОборота КАК СуммаВал,
	ТЗПроводок.Сумма * ТЗПроводок.ЗнакОборота КАК Сумма,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт1
			ИНАЧЕ ТЗПроводок.СубконтоКт1
		КОНЕЦ) КАК СтрокаКорСубконто1,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт2
			ИНАЧЕ ТЗПроводок.СубконтоКт2
		КОНЕЦ) КАК СтрокаКорСубконто2,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт3
			ИНАЧЕ ТЗПроводок.СубконтоКт3
		КОНЕЦ) КАК СтрокаКорСубконто3,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ВЫБОР
						КОГДА ТЗПроводок.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт1
						КОГДА ТЗПроводок.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт2
						КОГДА ТЗПроводок.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт3
						ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
					КОНЕЦ
			КОГДА ТЗПроводок.КонтрПоКТ
				ТОГДА ВЫБОР
						КОГДА ТЗПроводок.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт1
						КОГДА ТЗПроводок.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт2
						КОГДА ТЗПроводок.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт3
						ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
					КОНЕЦ
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов) КАК Договор,
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.Регистратор) КАК ДокументРасчетов,
	ТЗПроводок.Регистратор.Номер КАК НомерДокумента,
	ТЗПроводок.Регистратор.Дата КАК ДатаДокумента,
	ПРЕДСТАВЛЕНИЕ(ТИПЗНАЧЕНИЯ(ТЗПроводок.Регистратор)) КАК ВидДокумента,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
			КОГДА ТЗПроводок.КонтрПоКТ
				ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОНЕЦ КАК Перечисление.неоСторонаКонтрагента) КАК КтДт,
	ТЗПроводок.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТКонтрагентыГруппы.ОтношениеКГруппе КАК Перечисление.неоВидыОтношенийКГруппе) КАК ВидОтношенияКГруппе,
	ТЗПроводок.ЭтоОП КАК ЭтоОП,
	ТЗПроводок.КонтрагентКтУАгента КАК КонтрагентКтУАгента,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
					И ТЗПроводок.КонтрПоКТ
				ТОГДА ВЫБОР
						КОГДА ТЗПроводок.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт1
						КОГДА ТЗПроводок.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт2
						КОГДА ТЗПроводок.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт3
						ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
					КОНЕЦ
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов) КАК СвязанныйДоговорНаСторонеАгента,
	ТЗПроводок.КонтрПоДТ КАК КонтрПоДТ,
	ТЗПроводок.КонтрПоКТ КАК КонтрПоКТ,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
				И НЕ ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетКт.Вид
		КОГДА ТЗПроводок.КонтрПоДТ
				И ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетДт.Вид
		ИНАЧЕ ТЗПроводок.СчетДт.Вид
	КОНЕЦ КАК СчетВид,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
				И НЕ ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетДт.Вид
		КОГДА ТЗПроводок.КонтрПоДТ
				И ТЗПроводок.КонтрПоКТ
			ТОГДА ТЗПроводок.СчетКт.Вид
		ИНАЧЕ ТЗПроводок.СчетКт.Вид
	КОНЕЦ КАК КоррСчетВид
ПОМЕСТИТЬ ВТSourcePL
ИЗ
	ТЗПроводок КАК ТЗПроводок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКонтрагентыГруппы КАК ВТКонтрагентыГруппы
		ПО ТЗПроводок.Контрагент.ИНН = ВТКонтрагентыГруппы.ИНН
			И ТЗПроводок.Контрагент.КПП = ВТКонтрагентыГруппы.КПП
			И (НАЧАЛОПЕРИОДА(ТЗПроводок.Период, ДЕНЬ) >= НАЧАЛОПЕРИОДА(ВТКонтрагентыГруппы.ДатаИзмененияСтатуса, ДЕНЬ))
			И (ВЫБОР
				КОГДА ВТКонтрагентыГруппы.ДатаВыбытия = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					ТОГДА ИСТИНА
				ИНАЧЕ КОНЕЦПЕРИОДА(ТЗПроводок.Период, ДЕНЬ) < ВТКонтрагентыГруппы.ДатаВыбытия
			КОНЕЦ)
ГДЕ
	НЕ ТЗПроводок.ЭтоОП

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	(ВЫРАЗИТЬ(ТЗПроводок.СчетДт.Код КАК СТРОКА(10))) + ", " + (ВЫРАЗИТЬ(ТЗПроводок.СчетДт.Наименование КАК СТРОКА(20))) + ", " + (ВЫРАЗИТЬ(ТЗПроводок.СубконтоДт1.Наименование КАК СТРОКА(50))),
	ТЗПроводок.КонтрагентКтУАгента,
	ТЗПроводок.КонтрагентКтУАгента.ИНН,
	ТЗПроводок.СчетКт.Код,
	ТЗПроводок.СчетДт.Код,
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоДт1),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоДт2),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоДт3),
	ВЫРАЗИТЬ(ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL) КАК Перечисление.неоФормыОтчетности),
	"",
	"",
	ТЗПроводок.СуммаВал,
	ТЗПроводок.Сумма,
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоКт1),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоКт2),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.СубконтоКт3),
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоКт1
			КОГДА ТЗПроводок.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоКт2
			КОГДА ТЗПроводок.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоКт3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.Регистратор),
	ТЗПроводок.Регистратор.Номер,
	ТЗПроводок.Регистратор.Дата,
	ПРЕДСТАВЛЕНИЕ(ТИПЗНАЧЕНИЯ(ТЗПроводок.Регистратор)),
	ВЫРАЗИТЬ(ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт) КАК Перечисление.неоСторонаКонтрагента),
	ТЗПроводок.ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТКонтрагентыГруппы.ОтношениеКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ТЗПроводок.ЭтоОП,
	ТЗПроводок.Контрагент,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоДт1
			КОГДА ТЗПроводок.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоДт2
			КОГДА ТЗПроводок.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ТОГДА ТЗПроводок.СубконтоДт3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов),
	ТЗПроводок.КонтрПоДТ,
	ТЗПроводок.КонтрПоКТ,
	ТЗПроводок.СчетКт.Вид,
	ТЗПроводок.СчетДт.Вид
ИЗ
	ТЗПроводок КАК ТЗПроводок
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКонтрагентыГруппы КАК ВТКонтрагентыГруппы
		ПО ТЗПроводок.КонтрагентКтУАгента.ИНН = ВТКонтрагентыГруппы.ИНН
			И ТЗПроводок.КонтрагентКтУАгента.КПП = ВТКонтрагентыГруппы.КПП
			И (НАЧАЛОПЕРИОДА(ТЗПроводок.Период, ДЕНЬ) >= НАЧАЛОПЕРИОДА(ВТКонтрагентыГруппы.ДатаИзмененияСтатуса, ДЕНЬ))
			И (ВЫБОР
				КОГДА ВТКонтрагентыГруппы.ДатаВыбытия = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					ТОГДА ИСТИНА
				ИНАЧЕ КОНЕЦПЕРИОДА(ТЗПроводок.Период, ДЕНЬ) < ВТКонтрагентыГруппы.ДатаВыбытия
			КОНЕЦ)
ГДЕ
	НЕ ТЗПроводок.ЭтоОП
	И ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
					И ТЗПроводок.КонтрПоКТ
				ТОГДА ИСТИНА
			ИНАЧЕ ЛОЖЬ
		КОНЕЦ

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	(ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СчетКт.Код
			ИНАЧЕ ТЗПроводок.СчетДт.Код
		КОНЕЦ КАК СТРОКА(10))) + ", " + (ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СчетКт.Наименование
			ИНАЧЕ ТЗПроводок.СчетДт.Наименование
		КОНЕЦ КАК СТРОКА(20))) + ", " + (ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт1.Наименование
			ИНАЧЕ ТЗПроводок.СубконтоДт1.Наименование
		КОНЕЦ КАК СТРОКА(50))),
	ТЗПроводок.Контрагент,
	ТЗПроводок.Контрагент.ИНН,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
			ТОГДА ТЗПроводок.СчетКт.Код
		ИНАЧЕ ТЗПроводок.СчетДт.Код
	КОНЕЦ,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
			ТОГДА ТЗПроводок.СчетДт.Код
		ИНАЧЕ ТЗПроводок.СчетКт.Код
	КОНЕЦ,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт1
			ИНАЧЕ ТЗПроводок.СубконтоДт1
		КОНЕЦ),
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт2
			ИНАЧЕ ТЗПроводок.СубконтоДт2
		КОНЕЦ),
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоКт3
			ИНАЧЕ ТЗПроводок.СубконтоДт3
		КОНЕЦ),
	ВЫРАЗИТЬ(ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL) КАК Перечисление.неоФормыОтчетности),
	"",
	"",
	ТЗПроводок.СуммаВал * ТЗПроводок.ЗнакОборота,
	ТЗПроводок.Сумма * ТЗПроводок.ЗнакОборота,
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт1
			ИНАЧЕ ТЗПроводок.СубконтоКт1
		КОНЕЦ),
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт2
			ИНАЧЕ ТЗПроводок.СубконтоКт2
		КОНЕЦ),
	ПРЕДСТАВЛЕНИЕ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ТЗПроводок.СубконтоДт3
			ИНАЧЕ ТЗПроводок.СубконтоКт3
		КОНЕЦ),
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ВЫБОР
						КОГДА ТЗПроводок.ВидСубконтоДт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт1
						КОГДА ТЗПроводок.ВидСубконтоДт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт2
						КОГДА ТЗПроводок.ВидСубконтоДт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоДт3
						ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
					КОНЕЦ
			КОГДА ТЗПроводок.КонтрПоКТ
				ТОГДА ВЫБОР
						КОГДА ТЗПроводок.ВидСубконтоКт1 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт1
						КОГДА ТЗПроводок.ВидСубконтоКт2 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт2
						КОГДА ТЗПроводок.ВидСубконтоКт3 = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
							ТОГДА ТЗПроводок.СубконтоКт3
						ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
					КОНЕЦ
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов),
	ПРЕДСТАВЛЕНИЕ(ТЗПроводок.Регистратор),
	ТЗПроводок.Регистратор.Номер,
	ТЗПроводок.Регистратор.Дата,
	ПРЕДСТАВЛЕНИЕ(ТИПЗНАЧЕНИЯ(ТЗПроводок.Регистратор)),
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТЗПроводок.КонтрПоДТ
				ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
			КОГДА ТЗПроводок.КонтрПоКТ
				ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОНЕЦ КАК Перечисление.неоСторонаКонтрагента),
	ТЗПроводок.ОбособленноеПодразделение,
	ЗНАЧЕНИЕ(Перечисление.неоВидыОтношенийКГруппе.Дочернее),
	ТЗПроводок.ЭтоОП,
	ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка),
	ТЗПроводок.КонтрПоДТ,
	ТЗПроводок.КонтрПоКТ,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
			ТОГДА ТЗПроводок.СчетКт.Вид
		ИНАЧЕ ТЗПроводок.СчетДт.Вид
	КОНЕЦ,
	ВЫБОР
		КОГДА ТЗПроводок.КонтрПоДТ
			ТОГДА ТЗПроводок.СчетДт.Вид
		ИНАЧЕ ТЗПроводок.СчетКт.Вид
	КОНЕЦ
ИЗ
	ТЗПроводок КАК ТЗПроводок
ГДЕ
	ТЗПроводок.ЭтоОП
	И (ТЗПроводок.СчетДт.Код ПОДОБНО "10%"
			ИЛИ ТЗПроводок.СчетДт.Код ПОДОБНО "20%"
			ИЛИ (ТЗПроводок.СчетКт.Код ПОДОБНО "43%"
				ИЛИ ТЗПроводок.СчетКт.Код ПОДОБНО "45%"
				ИЛИ ТЗПроводок.СчетКт.Код ПОДОБНО "41%"))
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТЗПроводок
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ХозрасчетныйОстатки.Счет.Код КАК Счет,
	ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.BS) КАК ФО,
	ВЫРАЗИТЬ(ВЫРАЗИТЬ(ВЫБОР
				КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто1) = ТИП(Справочник.ДоговорыКонтрагентов)
					ТОГДА ХозрасчетныйОстатки.Субконто1
				КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто2) = ТИП(Справочник.ДоговорыКонтрагентов)
					ТОГДА ХозрасчетныйОстатки.Субконто2
				КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто3) = ТИП(Справочник.ДоговорыКонтрагентов)
					ТОГДА ХозрасчетныйОстатки.Субконто3
				ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
			КОНЕЦ КАК Справочник.ДоговорыКонтрагентов).Владелец КАК Справочник.Контрагенты) КАК Контрагент,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто1) = ТИП(Справочник.ДоговорыКонтрагентов)
				ТОГДА ХозрасчетныйОстатки.Субконто1
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто2) = ТИП(Справочник.ДоговорыКонтрагентов)
				ТОГДА ХозрасчетныйОстатки.Субконто2
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто3) = ТИП(Справочник.ДоговорыКонтрагентов)
				ТОГДА ХозрасчетныйОстатки.Субконто3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
		КОНЕЦ КАК Справочник.ДоговорыКонтрагентов) КАК Договор,
	ВЫРАЗИТЬ(ВЫБОР
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто1) = ТИП(Справочник.Организации)
				ТОГДА ХозрасчетныйОстатки.Субконто1
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто2) = ТИП(Справочник.Организации)
				ТОГДА ХозрасчетныйОстатки.Субконто2
			КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто3) = ТИП(Справочник.Организации)
				ТОГДА ХозрасчетныйОстатки.Субконто3
			ИНАЧЕ ЗНАЧЕНИЕ(Справочник.Организации.ПустаяСсылка)
		КОНЕЦ КАК Справочник.Организации) КАК ОбособленноеПодразделение,
	ВЫБОР
		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто1) = ТИП(Справочник.Организации)
			ТОГДА ИСТИНА
		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто2) = ТИП(Справочник.Организации)
			ТОГДА ИСТИНА
		КОГДА ТИПЗНАЧЕНИЯ(ХозрасчетныйОстатки.Субконто3) = ТИП(Справочник.Организации)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ЭтоОП,
	ВЫБОР
		КОГДА ХозрасчетныйОстатки.СуммаОстаток < 0
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		ИНАЧЕ ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
	КОНЕЦ КАК КтДт,
	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйОстатки.Субконто1) КАК Субконто1,
	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйОстатки.Субконто2) КАК Субконто2,
	ПРЕДСТАВЛЕНИЕ(ХозрасчетныйОстатки.Субконто3) КАК Субконто3,
	ХозрасчетныйОстатки.Организация КАК Организация,
	ХозрасчетныйОстатки.СуммаОстаток КАК СуммаОстаток,
	ХозрасчетныйОстатки.ВалютнаяСуммаОстаток КАК ВалютнаяСуммаОстаток,
	ХозрасчетныйОстатки.Счет.Вид КАК СчетВид
ПОМЕСТИТЬ ТЗОстатки
ИЗ
	РегистрБухгалтерии.Хозрасчетный.Остатки(
			НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&ДатаКон, ДЕНЬ, 1), ДЕНЬ),
			(Счет.ВидыСубконто.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.Договоры)
				ИЛИ Счет.ВидыСубконто.ВидСубконто = ЗНАЧЕНИЕ(ПланВидовХарактеристик.ВидыСубконтоХозрасчетные.ОбособленныеПодразделения))
				И ВЫБОР
					КОГДА Счет.КодБыстрогоВыбора = "020"
							ИЛИ Счет.КодБыстрогоВыбора = "021"
						ТОГДА ИСТИНА
					КОГДА Счет.Забалансовый
						ТОГДА ЛОЖЬ
					ИНАЧЕ ИСТИНА
				КОНЕЦ
				И Счет.Код <> "10.07"
				И Счет.Код <> "63"
				И НЕ Счет.Код ПОДОБНО "57%",
			,
			Организация = &Организация) КАК ХозрасчетныйОстатки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	"" КАК СчетИАналитика,
	ТЗОстатки.Контрагент КАК Контрагент,
	ТЗОстатки.Контрагент.ИНН КАК ИНН,
	"" КАК СтрокаКоррСчет,
	ТЗОстатки.ФО КАК ФО,
	"" КАК НазваниеОперации,
	"" КАК Статья,
	ТЗОстатки.СуммаОстаток КАК Сумма,
	ТЗОстатки.ВалютнаяСуммаОстаток КАК СуммаВал,
	"" КАК СтрокаКорСубконто1,
	"" КАК СтрокаКорСубконто2,
	"" КАК СтрокаКорСубконто3,
	ТЗОстатки.Договор КАК Договор,
	"" КАК ДокументРасчетов,
	"" КАК НомерДокумента,
	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0) КАК ДатаДокумента,
	"" КАК ВидДокумента,
	ТЗОстатки.КтДт КАК КтДт,
	ТЗОстатки.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТКонтрагентыГруппы.ОтношениеКГруппе КАК Перечисление.неоВидыОтношенийКГруппе) КАК ВидОтношенияКГруппе,
	ТЗОстатки.ЭтоОП КАК ЭтоОП,
	ТЗОстатки.Счет КАК Счет,
	ТЗОстатки.Субконто1 КАК Субконто1,
	ТЗОстатки.Субконто2 КАК Субконто2,
	ТЗОстатки.Субконто3 КАК Субконто3,
	ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка) КАК КонтрагентКтУАгента,
	ЗНАЧЕНИЕ(Справочник.ДоговорыКОнтрагентов.ПустаяСсылка) КАК СвязанныйДоговорНаСторонеАгента,
	ТЗОстатки.СчетВид КАК СчетВид,
	ЗНАЧЕНИЕ(ВидСчета.Активный) КАК КоррСчетВид
ПОМЕСТИТЬ ВТSourceBS
ИЗ
	ТЗОстатки КАК ТЗОстатки
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКонтрагентыГруппы КАК ВТКонтрагентыГруппы
		ПО (ВЫБОР
				КОГДА НЕ ТЗОстатки.ЭтоОП
					ТОГДА ТЗОстатки.Контрагент.ИНН = ВТКонтрагентыГруппы.ИНН
							И ТЗОстатки.Контрагент.КПП = ВТКонтрагентыГруппы.КПП
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ)
			И (ВЫБОР
				КОГДА ВТКонтрагентыГруппы.ДатаВыбытия = ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
					ТОГДА ИСТИНА
				ИНАЧЕ ВТКонтрагентыГруппы.ДатаВыбытия > &ДатаКон
			КОНЕЦ)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	"",
	ТЗОстатки.Контрагент,
	ТЗОстатки.Контрагент.ИНН,
	"",
	ТЗОстатки.ФО,
	"",
	"",
	ТЗОстатки.СуммаОстаток,
	ТЗОстатки.ВалютнаяСуммаОстаток,
	"",
	"",
	"",
	ТЗОстатки.Договор,
	"",
	"",
	ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0),
	"",
	ТЗОстатки.КтДт,
	ТЗОстатки.ОбособленноеПодразделение,
	ЗНАЧЕНИЕ(Перечисление.неоВидыОтношенийКГруппе.Дочернее),
	ТЗОстатки.ЭтоОП,
	ТЗОстатки.Счет,
	ТЗОстатки.Субконто1,
	ТЗОстатки.Субконто2,
	ТЗОстатки.Субконто3,
	ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка),
	ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка),
	ТЗОстатки.СчетВид,
	ЗНАЧЕНИЕ(ВидСчета.Активный)
ИЗ
	ТЗОстатки КАК ТЗОстатки
ГДЕ
	ТЗОстатки.ЭтоОП = ИСТИНА
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТЗОстатки
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТSourcePL.ДатаДокумента КАК ДатаДокумента,
	ВТSourcePL.СчетИАналитика КАК СчетИАналитика,
	ВЫБОР
		КОГДА ВТSourcePL.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
				И ВТSourcePL.КонтрагентКтУАгента <> ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВТSourcePL.КонтрагентКтУАгента
		ИНАЧЕ ВТSourcePL.Контрагент
	КОНЕЦ КАК Контрагент,
	ВТSourcePL.ИНН КАК ИНН,
	ВТSourcePL.СтрокаСчет КАК СтрокаСчет,
	ВТSourcePL.СтрокаКоррСчет КАК СтрокаКоррСчет,
	ВТSourcePL.СтрокаСубконто1 КАК СтрокаСубконто1,
	ВТSourcePL.СтрокаСубконто2 КАК СтрокаСубконто2,
	ВТSourcePL.СтрокаСубконто3 КАК СтрокаСубконто3,
	ВТSourcePL.ФО КАК ФО,
	ВТSourcePL.НазваниеОперации КАК НазваниеОперации,
	ВТSourcePL.Статья КАК Статья,
	СУММА(ВТSourcePL.СуммаВал) КАК СуммаВал,
	СУММА(ВТSourcePL.Сумма) КАК Сумма,
	ВТSourcePL.СтрокаКорСубконто1 КАК СтрокаКорСубконто1,
	ВТSourcePL.СтрокаКорСубконто2 КАК СтрокаКорСубконто2,
	ВТSourcePL.СтрокаКорСубконто3 КАК СтрокаКорСубконто3,
	ВТSourcePL.Договор КАК Договор,
	ВТSourcePL.ДокументРасчетов КАК ДокументРасчетов,
	ВЫРАЗИТЬ(ВТSourcePL.НомерДокумента КАК СТРОКА(15)) КАК НомерДокумента,
	ВТSourcePL.ВидДокумента КАК ВидДокумента,
	ВТSourcePL.КтДт КАК КтДт,
	ВТSourcePL.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТSourcePL.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе) КАК ВидОтношенияКГруппе,
	ВТSourcePL.ЭтоОП КАК ЭтоОП,
	ВТSourcePL.КонтрагентКтУАгента КАК КонтрагентКтУАгента,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента КАК СвязанныйДоговорНаСторонеАгента,
	ЛОЖЬ КАК УчетУАгента,
	ВТSourcePL.СчетВид КАК СчетВид,
	ВТSourcePL.КоррСчетВид КАК КоррСчетВид,
	ВТSourcePL.Договор.ВидДоговора КАК ВидДоговора,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента.ВидАгентскогоДоговора КАК ВидСвязанногоДоговора
ПОМЕСТИТЬ ВТДанные
ИЗ
	ВТSourcePL КАК ВТSourcePL
ГДЕ
	ВТSourcePL.КонтрПоДТ <> ВТSourcePL.КонтрПоКТ

СГРУППИРОВАТЬ ПО
	ВТSourcePL.СчетИАналитика,
	ВТSourcePL.СтрокаСчет,
	ВТSourcePL.ДатаДокумента,
	ВТSourcePL.ИНН,
	ВТSourcePL.СтрокаСубконто3,
	ВТSourcePL.Статья,
	ВТSourcePL.СтрокаКорСубконто3,
	ВТSourcePL.ДокументРасчетов,
	ВТSourcePL.СтрокаСубконто2,
	ВТSourcePL.СтрокаКорСубконто2,
	ВТSourcePL.ВидДокумента,
	ВТSourcePL.СтрокаКоррСчет,
	ВТSourcePL.НазваниеОперации,
	ВТSourcePL.СтрокаСубконто1,
	ВТSourcePL.СтрокаКорСубконто1,
	ВТSourcePL.Договор,
	ВТSourcePL.ФО,
	ВЫРАЗИТЬ(ВТSourcePL.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ВТSourcePL.ЭтоОП,
	ВТSourcePL.КтДт,
	ВТSourcePL.ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТSourcePL.НомерДокумента КАК СТРОКА(15)),
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента,
	ВТSourcePL.КонтрагентКтУАгента,
	ВЫБОР
		КОГДА ВТSourcePL.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
				И ВТSourcePL.КонтрагентКтУАгента <> ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)
			ТОГДА ВТSourcePL.КонтрагентКтУАгента
		ИНАЧЕ ВТSourcePL.Контрагент
	КОНЕЦ,
	ВТSourcePL.СчетВид,
	ВТSourcePL.КоррСчетВид,
	ВТSourcePL.Договор.ВидДоговора,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента.ВидАгентскогоДоговора

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТSourcePL.ДатаДокумента,
	ВТSourcePL.СчетИАналитика,
	ВТSourcePL.Контрагент,
	ВТSourcePL.ИНН,
	ВТSourcePL.СтрокаСчет,
	ВТSourcePL.СтрокаКоррСчет,
	ВТSourcePL.СтрокаСубконто1,
	ВТSourcePL.СтрокаСубконто2,
	ВТSourcePL.СтрокаСубконто3,
	ВТSourcePL.ФО,
	ВТSourcePL.НазваниеОперации,
	ВТSourcePL.Статья,
	СУММА(ВТSourcePL.СуммаВал),
	СУММА(ВТSourcePL.Сумма),
	ВТSourcePL.СтрокаКорСубконто1,
	ВТSourcePL.СтрокаКорСубконто2,
	ВТSourcePL.СтрокаКорСубконто3,
	ВТSourcePL.Договор,
	ВТSourcePL.ДокументРасчетов,
	ВЫРАЗИТЬ(ВТSourcePL.НомерДокумента КАК СТРОКА(15)),
	ВТSourcePL.ВидДокумента,
	ВТSourcePL.КтДт,
	ВТSourcePL.ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТSourcePL.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ВТSourcePL.ЭтоОП,
	ВТSourcePL.КонтрагентКтУАгента,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента,
	ИСТИНА,
	ВТSourcePL.СчетВид,
	ВТSourcePL.КоррСчетВид,
	ВТSourcePL.Договор.ВидДоговора,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента.ВидДоговора
ИЗ
	ВТSourcePL КАК ВТSourcePL
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТКонтрагентыГруппы КАК ВТКонтрагентыГруппы
		ПО ВТSourcePL.Контрагент.ИНН = ВТКонтрагентыГруппы.ИНН
			И ВТSourcePL.Контрагент.КПП = ВТКонтрагентыГруппы.КПП
ГДЕ
	ВТSourcePL.КонтрПоДТ
	И ВТSourcePL.КонтрПоКТ
	И ВЫБОР
			КОГДА ВТSourcePL.Договор <> ВТSourcePL.СвязанныйДоговорНаСторонеАгента
				ТОГДА ИСТИНА
			КОГДА ВТSourcePL.СтрокаСчет ПОДОБНО "76.05%"
					И ВТSourcePL.СтрокаКоррСчет ПОДОБНО "76.29.ДС%"
				ТОГДА ИСТИНА
			ИНАЧЕ (ВТSourcePL.СтрокаСчет ПОДОБНО "76.29.ДС%"
					ИЛИ ВТSourcePL.СтрокаСчет ПОДОБНО "76.05%")
					И (ВТSourcePL.СтрокаКоррСчет ПОДОБНО "76.29.3%"
						ИЛИ ВТSourcePL.СтрокаКоррСчет ПОДОБНО "76.05%")
		КОНЕЦ

СГРУППИРОВАТЬ ПО
	ВТSourcePL.СчетИАналитика,
	ВТSourcePL.СтрокаСчет,
	ВТSourcePL.ДатаДокумента,
	ВТSourcePL.Контрагент,
	ВТSourcePL.ИНН,
	ВТSourcePL.СтрокаСубконто3,
	ВТSourcePL.Статья,
	ВТSourcePL.СтрокаКорСубконто3,
	ВТSourcePL.ДокументРасчетов,
	ВТSourcePL.СтрокаСубконто2,
	ВТSourcePL.СтрокаКорСубконто2,
	ВТSourcePL.ВидДокумента,
	ВТSourcePL.СтрокаКоррСчет,
	ВТSourcePL.НазваниеОперации,
	ВТSourcePL.СтрокаСубконто1,
	ВТSourcePL.СтрокаКорСубконто1,
	ВТSourcePL.Договор,
	ВТSourcePL.ФО,
	ВЫРАЗИТЬ(ВТSourcePL.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ВТSourcePL.ЭтоОП,
	ВТSourcePL.КтДт,
	ВТSourcePL.ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТSourcePL.НомерДокумента КАК СТРОКА(15)),
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента,
	ВТSourcePL.КонтрагентКтУАгента,
	ВТSourcePL.КоррСчетВид,
	ВТSourcePL.СчетВид,
	ВТSourcePL.Договор.ВидДоговора,
	ВТSourcePL.СвязанныйДоговорНаСторонеАгента.ВидДоговора

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ВТSourceBS.ДатаДокумента,
	ВТSourceBS.СчетИАналитика,
	ВТSourceBS.Контрагент,
	ВТSourceBS.ИНН,
	ВТSourceBS.Счет,
	ВТSourceBS.СтрокаКоррСчет,
	ВТSourceBS.Субконто1,
	ВТSourceBS.Субконто2,
	ВТSourceBS.Субконто3,
	ВТSourceBS.ФО,
	ВТSourceBS.НазваниеОперации,
	ВТSourceBS.Статья,
	СУММА(ВТSourceBS.СуммаВал),
	СУММА(ВТSourceBS.Сумма),
	ВТSourceBS.СтрокаКорСубконто1,
	ВТSourceBS.СтрокаКорСубконто2,
	ВТSourceBS.СтрокаКорСубконто3,
	ВТSourceBS.Договор,
	ВТSourceBS.ДокументРасчетов,
	ВЫРАЗИТЬ(ВТSourceBS.НомерДокумента КАК СТРОКА(15)),
	ВТSourceBS.ВидДокумента,
	ВТSourceBS.КтДт,
	ВТSourceBS.ОбособленноеПодразделение,
	ВЫРАЗИТЬ(ВТSourceBS.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ВТSourceBS.ЭтоОП,
	ВТSourceBS.КонтрагентКтУАгента,
	ВТSourceBS.СвязанныйДоговорНаСторонеАгента,
	ЛОЖЬ,
	ВТSourceBS.СчетВид,
	ВТSourceBS.КоррСчетВид,
	ВТSourceBS.Договор.ВидДоговора,
	ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.ПустаяСсылка)
ИЗ
	ВТSourceBS КАК ВТSourceBS

СГРУППИРОВАТЬ ПО
	ВТSourceBS.ДатаДокумента,
	ВТSourceBS.СтрокаКорСубконто1,
	ВТSourceBS.СтрокаКорСубконто2,
	ВТSourceBS.НазваниеОперации,
	ВТSourceBS.Статья,
	ВТSourceBS.Договор,
	ВТSourceBS.ФО,
	ВТSourceBS.СчетИАналитика,
	ВТSourceBS.СтрокаКоррСчет,
	ВТSourceBS.ДокументРасчетов,
	ВТSourceBS.Субконто2,
	ВТSourceBS.КтДт,
	ВТSourceBS.ИНН,
	ВТSourceBS.Субконто3,
	ВТSourceBS.СтрокаКорСубконто3,
	ВТSourceBS.ВидДокумента,
	ВТSourceBS.Контрагент,
	ВТSourceBS.ОбособленноеПодразделение,
	ВТSourceBS.Счет,
	ВЫРАЗИТЬ(ВТSourceBS.ВидОтношенияКГруппе КАК Перечисление.неоВидыОтношенийКГруппе),
	ВТSourceBS.Субконто1,
	ВТSourceBS.ЭтоОП,
	ВЫРАЗИТЬ(ВТSourceBS.НомерДокумента КАК СТРОКА(15)),
	ВТSourceBS.КонтрагентКтУАгента,
	ВТSourceBS.СвязанныйДоговорНаСторонеАгента,
	ВТSourceBS.СчетВид,
	ВТSourceBS.КоррСчетВид,
	ВТSourceBS.Договор.ВидДоговора
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ВТSourceBS
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТДанные.ДатаДокумента КАК ДатаДокумента,
	ВТДанные.Контрагент КАК Контрагент,
	ВТДанные.ИНН КАК ИНН,
	ВТДанные.СтрокаСчет КАК СтрокаСчет,
	ВТДанные.СтрокаКоррСчет КАК СтрокаКоррСчет,
	ВТДанные.ФО КАК ФО,
	ВТДанные.НазваниеОперации КАК НазваниеОперации,
	ВТДанные.Статья КАК Статья,
	СУММА(ВТДанные.СуммаВал) КАК СуммаВал,
	СУММА(ВТДанные.Сумма) КАК Сумма,
	ВТДанные.Договор КАК Договор,
	ВТДанные.ДокументРасчетов КАК ДокументРасчетов,
	ВТДанные.НомерДокумента КАК НомерДокумента,
	ВТДанные.ВидДокумента КАК ВидДокумента,
	ВЫБОР
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СКомитентом)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СПокупателем)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СПоставщиком)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СКомиссионером)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.Сумма > 0
				И НЕ ВТДанные.СтрокаСчет ПОДОБНО "71%"
				И НЕ ВТДанные.КоррСчетВид = ЗНАЧЕНИЕ(ВидСчета.Активный)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.УчетУАгента
				И ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.Сумма < 0
				И ВТДанные.СчетВид = ЗНАЧЕНИЕ(ВидСчета.Пассивный)
				И ВТДанные.УчетУАгента
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		ИНАЧЕ ВТДанные.КтДт
	КОНЕЦ КАК КтДт,
	ВТДанные.ОбособленноеПодразделение КАК ОбособленноеПодразделение,
	ВТДанные.ВидОтношенияКГруппе КАК ВидОтношенияКГруппе,
	ВТДанные.ЭтоОП КАК ЭтоОП,
	ВТДанные.СвязанныйДоговорНаСторонеАгента КАК СвязанныйДоговорНаСторонеАгента,
	ВТДанные.УчетУАгента КАК УчетУАгента,
	"" КАК СтрокаСубконто1,
	"" КАК СтрокаСубконто2,
	"" КАК СтрокаСубконто3,
	"" КАК СтрокаКорСубконто1,
	"" КАК СтрокаКорСубконто2,
	"" КАК СтрокаКорСубконто3
ИЗ
	ВТДанные КАК ВТДанные

СГРУППИРОВАТЬ ПО
	ВТДанные.СвязанныйДоговорНаСторонеАгента,
	ВТДанные.УчетУАгента,
	ВТДанные.НазваниеОперации,
	ВТДанные.ИНН,
	ВТДанные.СтрокаСчет,
	ВТДанные.Контрагент,
	ВТДанные.ДатаДокумента,
	ВТДанные.СтрокаКоррСчет,
	ВТДанные.ФО,
	ВТДанные.Статья,
	ВТДанные.Договор,
	ВТДанные.ДокументРасчетов,
	ВТДанные.НомерДокумента,
	ВТДанные.ВидДокумента,
	ВТДанные.ОбособленноеПодразделение,
	ВТДанные.ВидОтношенияКГруппе,
	ВТДанные.ЭтоОП,
	ВЫБОР
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СКомитентом)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СПокупателем)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СПоставщиком)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И НЕ ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
				И ВТДанные.ВидДоговора = ЗНАЧЕНИЕ(Перечисление.ВидыДоговоровКонтрагентов.СКомиссионером)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.Сумма > 0
				И НЕ ВТДанные.СтрокаСчет ПОДОБНО "71%"
				И НЕ ВТДанные.КоррСчетВид = ЗНАЧЕНИЕ(ВидСчета.Активный)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.УчетУАгента
				И ВТДанные.Договор = ЗНАЧЕНИЕ(Справочник.ДоговорыКонтрагентов.ПустаяСсылка)
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
		КОГДА ВТДанные.КтДт = ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Дт)
				И ВТДанные.ФО = ЗНАЧЕНИЕ(Перечисление.неоФормыОтчетности.PL)
				И ВТДанные.Сумма < 0
				И ВТДанные.СчетВид = ЗНАЧЕНИЕ(ВидСчета.Пассивный)
				И ВТДанные.УчетУАгента
			ТОГДА ЗНАЧЕНИЕ(Перечисление.неоСторонаКонтрагента.Кт)
		ИНАЧЕ ВТДанные.КтДт
	КОНЕЦ
